Name: vim
Version: 7.2
Release: 4ev
Summary: The VIM (VIsual editor iMproved)
URL: http://www.vim.org/
Group: Applications/Editors
License: Charityware
Vendor: GNyU-Linux
Source0: ftp://ftp.vim.org/pub/vim/unix/vim-%{version}.tar.bz2
Source1: ftp://ftp.vim.org/pub/vim/extra/vim-%{version}-lang.tar.gz
Patch0: vim-7.2.001.diff                                                                     
Patch1: vim-7.2.002.diff                                                                     
Patch2: vim-7.2.003.diff                                                                     
Patch3: vim-7.2.004.diff                                                                     
Patch4: vim-7.2.005.diff                                                                     
Patch5: vim-7.2.006.diff                                                                     
Patch6: vim-7.2.007.diff                                                                     
Patch7: vim-7.2.008.diff                                                                     
Patch8: vim-7.2.009.diff                                                                     
Patch9: vim-7.2.010.diff                                                                     
Patch10: vim-7.2.011.diff                                                                    
Patch11: vim-7.2.012.diff                                                                    
Patch12: vim-7.2.013.diff                                                                    
Patch13: vim-7.2.014.diff                                                                    
Patch14: vim-7.2.015.diff                                                                    
Patch15: vim-7.2.016.diff                                                                    
Patch16: vim-7.2.017.diff                                                                    
Patch17: vim-7.2.018.diff                                                                    
Patch18: vim-7.2.019.diff                                                                    
Patch19: vim-7.2.020.diff                                                                    
Patch20: vim-7.2.021.diff                                                                    
Patch21: vim-7.2.022.diff                                                                    
Patch22: vim-7.2.023.diff                                                                    
Patch23: vim-7.2.024.diff                                                                    
Patch24: vim-7.2.025.diff                                                                    
Patch25: vim-7.2.026.diff                                                                    
Patch26: vim-7.2.027.diff                                                                    
Patch27: vim-7.2.028.diff                                                                    
Patch28: vim-7.2.029.diff                                                                    
Patch29: vim-7.2.030.diff                                                                    
Patch30: vim-7.2.031.diff                                                                    
Patch31: vim-7.2.032.diff                                                                    
Patch32: vim-7.2.033.diff                                                                    
Patch33: vim-7.2.034.diff                                                                    
Patch34: vim-7.2.035.diff                                                                    
Patch35: vim-7.2.036.diff                                                                    
Patch36: vim-7.2.037.diff                                                                    
Patch37: vim-7.2.038.diff                                                                    
Patch38: vim-7.2.039.diff                                                                    
Patch39: vim-7.2.040.diff                                                                    
Patch40: vim-7.2.041.diff                                                                    
Patch41: vim-7.2.042.diff                                                                    
Patch42: vim-7.2.043.diff                                                                    
Patch43: vim-7.2.044.diff                                                                    
Patch44: vim-7.2.045.diff                                                                    
Patch45: vim-7.2.046.diff                                                                    
Patch46: vim-7.2.047.diff                                                                    
Patch47: vim-7.2.048.diff                                                                    
Patch48: vim-7.2.049.diff                                                                    
Patch49: vim-7.2.050.diff                                                                    
Patch50: vim-7.2.051.diff                                                                    
Patch51: vim-7.2.052.diff                                                                    
Patch52: vim-7.2.053.diff                                                                    
Patch53: vim-7.2.054.diff                                                                    
Patch54: vim-7.2.055.diff                                                                    
Patch55: vim-7.2.056.diff                                                                    
Patch56: vim-7.2.057.diff                                                                    
Patch57: vim-7.2.058.diff                                                                    
Patch58: vim-7.2.059.diff                                                                    
Patch59: vim-7.2.060.diff                                                                    
Patch60: vim-7.2.061.diff                                                                    
Patch61: vim-7.2.062.diff                                                                    
Patch62: vim-7.2.063.diff                                                                    
Patch63: vim-7.2.064.diff                                                                    
Patch64: vim-7.2.065.diff                                                                    
Patch65: vim-7.2.066.diff                                                                    
Patch66: vim-7.2.067.diff                                                                    
Patch67: vim-7.2.068.diff                                                                    
Patch68: vim-7.2.069.diff                                                                    
Patch69: vim-7.2.070.diff                                                                    
Patch70: vim-7.2.071.diff                                                                    
Patch71: vim-7.2.072.diff                                                                    
Patch72: vim-7.2.073.diff                                                                    
Patch73: vim-7.2.074.diff                                                                    
Patch74: vim-7.2.075.diff                                                                    
Patch75: vim-7.2.076.diff                                                                    
Patch76: vim-7.2.077.diff                                                                    
Patch77: vim-7.2.078.diff                                                                    
Patch78: vim-7.2.079.diff                                                                    
Patch79: vim-7.2.080.diff                                                                    
Patch80: vim-7.2.081.diff                                                                    
Patch81: vim-7.2.082.diff                                                                    
Patch82: vim-7.2.083.diff                                                                    
Patch83: vim-7.2.084.diff                                                                    
Patch84: vim-7.2.085.diff                                                                    
Patch85: vim-7.2.086.diff                                                                    
Patch86: vim-7.2.087.diff                                                                    
Patch87: vim-7.2.088.diff                                                                    
Patch88: vim-7.2.089.diff                                                                    
Patch89: vim-7.2.090.diff                                                                    
Patch90: vim-7.2.091.diff                                                                    
Patch91: vim-7.2.092.diff                                                                    
Patch92: vim-7.2.093.diff                                                                    
Patch93: vim-7.2.094.diff                                                                    
Patch94: vim-7.2.095.diff                                                                    
Patch95: vim-7.2.096.diff                                                                    
Patch96: vim-7.2.097.diff                                                                    
Patch97: vim-7.2.098.diff                                                                    
Patch98: vim-7.2.099.diff                                                                    
Patch99: vim-7.2.100.diff                                                                    
Patch100: vim-7.2.101.diff                                                                   
Patch101: vim-7.2.102.diff                                                                   
Patch102: vim-7.2.103.diff                                                                   
Patch103: vim-7.2.104.diff                                                                   
Patch104: vim-7.2.105.diff                                                                   
Patch105: vim-7.2.106.diff                                                                   
Patch106: vim-7.2.107.diff                                                                   
Patch107: vim-7.2.108.diff                                                                   
Patch108: vim-7.2.109.diff                                                                   
Patch109: vim-7.2.110.diff                                                                   
Patch110: vim-7.2.111.diff                                                                   
Patch111: vim-7.2.112.diff                                                                   
Patch112: vim-7.2.113.diff                                                                   
Patch113: vim-7.2.114.diff                                                                   
Patch114: vim-7.2.115.diff                                                                   
Patch115: vim-7.2.116.diff                                                                   
Patch116: vim-7.2.117.diff                                                                   
Patch117: vim-7.2.118.diff                                                                   
Patch118: vim-7.2.119.diff                                                                   
Patch119: vim-7.2.120.diff                                                                   
Patch120: vim-7.2.121.diff                                                                   
Patch121: vim-7.2.122.diff                                                                   
Patch122: vim-7.2.123.diff                                                                   
Patch123: vim-7.2.124.diff                                                                   
Patch124: vim-7.2.125.diff                                                                   
Patch125: vim-7.2.126.diff                                                                   
Patch126: vim-7.2.127.diff                                                                   
Patch127: vim-7.2.128.diff                                                                   
Patch128: vim-7.2.129.diff                                                                   
Patch129: vim-7.2.130.diff                                                                   
Patch130: vim-7.2.131.diff                                                                   
Patch131: vim-7.2.132.diff                                                                   
Patch132: vim-7.2.133.diff
Patch133: vim-7.2.134.diff
Patch134: vim-7.2.135.diff
Patch135: vim-7.2.136.diff
Patch136: vim-7.2.137.diff
Patch137: vim-7.2.138.diff
Patch138: vim-7.2.139.diff
Patch139: vim-7.2.140.diff
Patch140: vim-7.2.141.diff
Patch141: vim-7.2.142.diff
Patch142: vim-7.2.143.diff
Patch143: vim-7.2.144.diff
Patch144: vim-7.2.145.diff
Patch145: vim-7.2.146.diff
Patch146: vim-7.2.147.diff
Patch147: vim-7.2.148.diff
Patch148: vim-7.2.149.diff
Patch149: vim-7.2.150.diff
Patch150: vim-7.2.151.diff
Patch151: vim-7.2.152.diff
Patch152: vim-7.2.153.diff
Patch153: vim-7.2.154.diff
Patch154: vim-7.2.155.diff
Patch155: vim-7.2.156.diff
Patch156: vim-7.2.157.diff
Patch157: vim-7.2.158.diff
Patch158: vim-7.2.159.diff
Patch159: vim-7.2.160.diff
Patch160: vim-7.2.161.diff
Patch161: vim-7.2.162.diff
Patch162: vim-7.2.163.diff
Patch163: vim-7.2.164.diff
Patch164: vim-7.2.165.diff
Patch165: vim-7.2.166.diff
BuildRequires: make, pkg-config, gcc, gettext
BuildRequires: libX11, libICE, libXdmcp, libXpm
BuildRequires: ncurses, gtk2
BuildRequires: perl, python, libattr, libacl
Requires: %{name}-common = %{version}-%{release}
Obsoletes: vim-minimal, vim-enhanced

%description
VIM (VIsual editor iMproved) is an updated and improved version of the
vi editor.  Vi was the first real screen-based editor for UNIX, and is
still very popular.  VIM improves on vi by adding new features:
multiple windows, multi-level undo, block highlighting and more.


%package common
Summary: The common files needed by any version of the VIM editor.
Group: Applications/Editors

%description common
VIM (VIsual editor iMproved) is an updated and improved version of the
vi editor.  Vi was the first real screen-based editor for UNIX, and is
still very popular.  VIM improves on vi by adding new features:
multiple windows, multi-level undo, block highlighting and more.  The
vim-common package contains files which every VIM binary will need in
order to run.
If you are installing vim-enhanced or vim-X11, you'll also need
to install the vim-common package.


%package X11
Summary: The VIM version of the vi editor for the X Window System.
Group: Applications/Editors
Requires: vim-common = %{version}-%{release}

%description X11
VIM (VIsual editor iMproved) is an updated and improved version of the
vi editor.  Vi was the first real screen-based editor for UNIX, and is
still very popular.  VIM improves on vi by adding new features:
multiple windows, multi-level undo, block highlighting and
more. VIM-X11 is a version of the VIM editor which will run within the
X Window System.  If you install this package, you can run VIM as an X
application with a full GUI interface and mouse support.

Install the vim-X11 package if you'd like to try out a version of vi
with graphics and mouse capabilities.  You'll also need to install the
vim-common package.



%prep
	%setup -q -c -a1
	pushd vim??
	%patch0 -p0
	%patch1 -p0
	%patch2 -p0
	%patch3 -p0
	%patch4 -p0
	%patch5 -p0
	%patch7 -p0
	%patch8 -p0
	%patch9 -p0
	%patch10 -p0
	%patch11 -p0
	%patch12 -p0
	%patch13 -p0
	%patch14 -p0
	%patch15 -p0
	%patch16 -p0
	%patch17 -p0
	%patch18 -p0
	%patch19 -p0
	%patch20 -p0
	%patch21 -p0
	%patch22 -p0
	%patch23 -p0
	%patch24 -p0
	%patch25 -p0
	%patch26 -p0
	%patch27 -p0
	%patch28 -p0
	%patch29 -p0
	%patch30 -p0
	%patch31 -p0
	%patch32 -p0
	%patch33 -p0
	%patch34 -p0
	%patch36 -p0
	%patch37 -p0
	%patch38 -p0
	%patch39 -p0
#	%patch40 -p0
	%patch41 -p0
	%patch42 -p0
	%patch43 -p0
	%patch44 -p0
	%patch45 -p0
	%patch46 -p0
	%patch47 -p0
	%patch49 -p0
	%patch50 -p0
	%patch51 -p0
	%patch52 -p0
	%patch53 -p0
	%patch54 -p0
	%patch55 -p0
	%patch56 -p0
	%patch57 -p0
	%patch58 -p0
	%patch59 -p0
	%patch60 -p0
	%patch61 -p0
	%patch62 -p0
	%patch63 -p0
	%patch64 -p0
	%patch65 -p0
	%patch66 -p0
	%patch67 -p0
	%patch68 -p0
	%patch69 -p0
#	%patch71 -p0
	%patch72 -p0
	%patch74 -p0
	%patch75 -p0
	%patch76 -p0
	%patch77 -p0
	%patch78 -p0
	%patch79 -p0
	%patch80 -p0
	%patch81 -p0
	%patch82 -p0
	%patch83 -p0
	%patch84 -p0
	%patch85 -p0
	%patch86 -p0
	%patch89 -p0
	%patch90 -p0
	%patch91 -p0
	%patch93 -p0
	%patch94 -p0
	%patch95 -p0
	%patch96 -p0
	%patch97 -p0
	%patch98 -p0
	%patch99 -p0
	%patch101 -p0
	%patch102 -p0
	%patch103 -p0
	%patch104 -p0
	%patch105 -p0
	%patch106 -p0
	%patch107 -p0
	%patch108 -p0
	%patch109 -p0
	%patch110 -p0
	%patch111 -p0
	%patch112 -p0
	%patch113 -p0
	%patch114 -p0
	%patch115 -p0
	%patch116 -p0
	%patch117 -p0
	%patch118 -p0
	%patch119 -p0
	%patch120 -p0
	%patch121 -p0
	%patch122 -p0
	%patch123 -p0
	%patch124 -p0
	%patch125 -p0
	%patch126 -p0
	%patch127 -p0
	%patch128 -p0
	%patch129 -p0
	%patch130 -p0
	%patch131 -p0
	%patch132 -p0
	%patch133 -p0
	%patch134 -p0
	%patch135 -p0
	%patch136 -p0
	%patch138 -p0
	%patch139 -p0
	%patch140 -p0
	%patch141 -p0
	%patch142 -p0
	%patch143 -p0
	%patch144 -p0
	%patch145 -p0
	%patch146 -p0
	%patch147 -p0
	%patch148 -p0
	#%patch149 -p0
	%patch150 -p0
	%patch151 -p0
	%patch152 -p0
	%patch153 -p0
	%patch154 -p0
	%patch155 -p0
	%patch156 -p0
	%patch157 -p0
	%patch158 -p0
	%patch159 -p0
	%patch160 -p0
	%patch161 -p0
	%patch162 -p0
	%patch163 -p0
	%patch164 -p0
	%patch165 -p0
	popd


%define vimdir vim%(echo %{version} | %{__sed} 's,\\.,,')


%build
	pushd '%{vimdir}'

	# First build the X-enabled version, and save it
	%configure \
		--with-features=huge \
		--with-x \
		--enable-xim \
		--enable-multibyte \
		--enable-gtk2-check \
		--enable-gui=gtk2 \
		--disable-gpm \
		--with-compiledby='%{packager}' \
		--enable-perlinterp \
		--enable-pythoninterp \
		--disable-rubyinterp \
		--disable-tclinterp
	%{__make} %{?_smp_mflags}
	cd src && %{__mv} -v vim gvim && cd ..

	# Clean up for the next build
	%{__make} clean

	# This is vim-enhanced, but without X
	%configure \
		--with-features=huge \
		--without-x \
		--disable-gui \
		--disable-xim \
		--disable-gpm \
		--enable-multibyte \
		--with-compiledby='%{packager}' \
		--disable-rubyinterp \
		--enable-perlinterp \
		--enable-pythoninterp \
		--disable-tclinterp
	%{__make} %{?_smp_mflags}

	popd


%install
	pushd '%{vimdir}'

	%{__make_install} -C src DESTDIR='%{buildroot}'

	# Install previously created X11-enabled vim binary
	%{__install} -m 0755 src/gvim '%{buildroot}/%{_bindir}/gvim'

	# Create links for X11-enabled vim
	pushd '%{buildroot}/%{_bindir}'
	for link in evim gex gview gvimdiff vimx
	do
		%{__ln_s} gvim "${link}"
	done
	popd

	# Icons for gvim
	%{__mkdir_p} '%{buildroot}/%{_datadir}/icons/hicolor'/{16x16,32x32,48x48}/apps
	for size in 16x16 32x32 48x48
	do
		%{__install} -m 0644 "runtime/vim${size}.png" \
		"%{buildroot}/%{_datadir}/icons/hicolor/${size}/apps/vim.png"
	done

	# We don't have csh, so this tool is no use at all. :o)
	%{__rm} '%{buildroot}/%{_datadir}/vim'/vim??/tools/vim132 || :

	# We only have UTF-8. Translate manpages paths
	pushd '%{buildroot}/%{_mandir}'
	%{__rm_rf} *.ISO8859* ru.KOI8-R
	for i in *.UTF-8
	do
		%{__rm_rf} "$(basename $i .UTF-8)"
		%{__mv} "$i" "$(basename $i .UTF-8)"	
	done
	popd

	# Make sure the manpages are set up correctly
	pushd '%{buildroot}/%{_mandir}'
	for path in $(find . -name vim.1\* -or -name vimdiff.1\*)
	do
		basename="${path##*/}"
		dir="${path%/*}"
		pushd "${dir}"
		%{__ln_s} "${basename}" "g${basename}"
		popd
	done
	popd

	popd


%files
	%defattr(-, root, root)
	%doc vim??/README*
	%{_bindir}/ex
	%{_bindir}/rview
	%{_bindir}/rvim
	%{_bindir}/view
	%{_bindir}/vim
	%{_bindir}/vimdiff
	%{_bindir}/vimtutor
	%{_bindir}/xxd
	%doc %{_mandir}/man1/ex.1*
	%doc %{_mandir}/man1/gvim.1*
	%doc %{_mandir}/man1/gvimdiff.1*
	%doc %{_mandir}/man1/rview.1*
	%doc %{_mandir}/man1/rvim.1*
	%doc %{_mandir}/man1/view.1*
	%doc %{_mandir}/man1/vim.1*
	%doc %{_mandir}/man1/vimdiff.1*
	%doc %{_mandir}/man1/vimtutor.1*
	%doc %{_mandir}/man1/xxd.1*
	%doc %{_mandir}/??/man1/ex.1*
	%doc %{_mandir}/??/man1/gvim.1*
	%doc %{_mandir}/??/man1/gvimdiff.1*
	%doc %{_mandir}/??/man1/rview.1*
	%doc %{_mandir}/??/man1/rvim.1*
	%doc %{_mandir}/??/man1/view.1*
	%doc %{_mandir}/??/man1/vim.1*
	%doc %{_mandir}/??/man1/vimdiff.1*
	%doc %{_mandir}/??/man1/vimtutor.1*
	%doc %{_mandir}/??/man1/xxd.1*


%files X11
	%defattr(-, root, root)
	%doc vim??/README*
	%{_bindir}/evim
	%{_bindir}/gex
	%{_bindir}/gview
	%{_bindir}/gvim
	%{_bindir}/gvimdiff
	#%{_bindir}/gvimtutor
	%{_bindir}/vimx
	%{_datadir}/icons/hicolor/*/apps/vim.png
	%doc %{_mandir}/man1/evim.1*
	%doc %{_mandir}/man1/gvim.1*
	%doc %{_mandir}/man1/gvimdiff.1*
	%doc %{_mandir}/??/man1/evim.1*
	%doc %{_mandir}/??/man1/gvim.1*
	%doc %{_mandir}/??/man1/gvimdiff.1*


%files common
	%defattr(-, root, root)
	%{_datadir}/vim/
