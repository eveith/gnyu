Name: vim
Version: 7.1
Release: 314.1ev
Summary: The VIM (VIsual editor iMproved)
URL: http://www.vim.org/
Group: Applications/Editors
License: Charityware
Vendor: GNyU-Linux
Source0: ftp://ftp.vim.org/pub/vim/unix/vim-%{version}.tar.bz2
Source1: ftp://ftp.vim.org/pub/vim/extra/vim-%{version}-lang.tar.gz
Patch0: vim-7.1.001
Patch1: vim-7.1.002
Patch2: vim-7.1.003
Patch3: vim-7.1.004
Patch4: vim-7.1.005
Patch5: vim-7.1.006
Patch6: vim-7.1.007
Patch7: vim-7.1.008
Patch8: vim-7.1.009
Patch9: vim-7.1.010
Patch10: vim-7.1.011
Patch11: vim-7.1.012
Patch12: vim-7.1.013
Patch13: vim-7.1.014
Patch14: vim-7.1.015
Patch15: vim-7.1.016
Patch16: vim-7.1.017
Patch17: vim-7.1.018
Patch18: vim-7.1.019
Patch19: vim-7.1.020
Patch20: vim-7.1.021
Patch21: vim-7.1.022
Patch22: vim-7.1.023
Patch23: vim-7.1.024
Patch24: vim-7.1.025
Patch25: vim-7.1.026
Patch26: vim-7.1.027
Patch27: vim-7.1.028
Patch28: vim-7.1.029
Patch29: vim-7.1.030
Patch30: vim-7.1.031
Patch31: vim-7.1.032
Patch32: vim-7.1.033
Patch33: vim-7.1.034
Patch34: vim-7.1.035
Patch35: vim-7.1.036
Patch36: vim-7.1.037
Patch37: vim-7.1.038
Patch38: vim-7.1.039
Patch39: vim-7.1.040
Patch40: vim-7.1.041
Patch41: vim-7.1.042
Patch42: vim-7.1.043
Patch43: vim-7.1.044
Patch44: vim-7.1.045
Patch45: vim-7.1.046
Patch46: vim-7.1.047
Patch47: vim-7.1.048
Patch48: vim-7.1.049
Patch49: vim-7.1.050
Patch50: vim-7.1.051
Patch51: vim-7.1.052
Patch52: vim-7.1.053
Patch53: vim-7.1.054
Patch54: vim-7.1.055
Patch55: vim-7.1.056
Patch56: vim-7.1.057
Patch57: vim-7.1.058
Patch58: vim-7.1.059
Patch59: vim-7.1.060
Patch60: vim-7.1.061
Patch61: vim-7.1.062
Patch62: vim-7.1.063
Patch63: vim-7.1.064
Patch64: vim-7.1.065
Patch65: vim-7.1.066
Patch66: vim-7.1.067
Patch67: vim-7.1.068
Patch68: vim-7.1.069
Patch69: vim-7.1.070
Patch70: vim-7.1.071
Patch71: vim-7.1.072
Patch72: vim-7.1.073
Patch73: vim-7.1.074
Patch74: vim-7.1.075
Patch75: vim-7.1.076
Patch76: vim-7.1.077
Patch77: vim-7.1.078
Patch78: vim-7.1.079
Patch79: vim-7.1.080
Patch80: vim-7.1.081
Patch81: vim-7.1.082
Patch82: vim-7.1.083
Patch83: vim-7.1.084
Patch84: vim-7.1.085
Patch85: vim-7.1.086
Patch86: vim-7.1.087
Patch87: vim-7.1.088
Patch88: vim-7.1.089
Patch89: vim-7.1.090
Patch90: vim-7.1.091
Patch91: vim-7.1.092
Patch92: vim-7.1.093
Patch93: vim-7.1.094
Patch94: vim-7.1.095
Patch95: vim-7.1.096
Patch96: vim-7.1.097
Patch97: vim-7.1.098
Patch98: vim-7.1.099
Patch99: vim-7.1.100
Patch100: vim-7.1.101
Patch101: vim-7.1.102
Patch102: vim-7.1.103
Patch103: vim-7.1.104
Patch104: vim-7.1.105
Patch105: vim-7.1.106
Patch106: vim-7.1.107
Patch107: vim-7.1.108
Patch108: vim-7.1.109
Patch109: vim-7.1.110
Patch110: vim-7.1.111
Patch111: vim-7.1.112
Patch112: vim-7.1.113
Patch113: vim-7.1.114
Patch114: vim-7.1.115
Patch115: vim-7.1.116
Patch116: vim-7.1.117
Patch117: vim-7.1.118
Patch118: vim-7.1.119
Patch119: vim-7.1.120
Patch120: vim-7.1.121
Patch121: vim-7.1.122
Patch122: vim-7.1.123
Patch123: vim-7.1.124
Patch124: vim-7.1.125
Patch125: vim-7.1.126
Patch126: vim-7.1.127
Patch127: vim-7.1.128
Patch128: vim-7.1.129
Patch129: vim-7.1.130
Patch130: vim-7.1.131
Patch131: vim-7.1.132
Patch132: vim-7.1.133
Patch133: vim-7.1.134
Patch134: vim-7.1.135
Patch135: vim-7.1.136
Patch136: vim-7.1.137
Patch137: vim-7.1.138
Patch138: vim-7.1.139
Patch139: vim-7.1.140
Patch140: vim-7.1.141
Patch141: vim-7.1.142
Patch142: vim-7.1.143
Patch143: vim-7.1.144
Patch144: vim-7.1.145
Patch145: vim-7.1.146
Patch146: vim-7.1.147
Patch147: vim-7.1.148
Patch148: vim-7.1.149
Patch149: vim-7.1.150
Patch150: vim-7.1.151
Patch151: vim-7.1.152
Patch152: vim-7.1.153
Patch153: vim-7.1.154
Patch154: vim-7.1.155
Patch155: vim-7.1.156
Patch156: vim-7.1.157
Patch157: vim-7.1.158
Patch158: vim-7.1.159
Patch159: vim-7.1.160
Patch160: vim-7.1.161
Patch161: vim-7.1.162
Patch162: vim-7.1.163
Patch163: vim-7.1.164
Patch164: vim-7.1.165
Patch165: vim-7.1.166
Patch166: vim-7.1.167
Patch167: vim-7.1.168
Patch168: vim-7.1.169
Patch169: vim-7.1.170
Patch170: vim-7.1.171
Patch171: vim-7.1.172
Patch172: vim-7.1.173
Patch173: vim-7.1.174
Patch174: vim-7.1.175
Patch175: vim-7.1.176
Patch176: vim-7.1.177
Patch177: vim-7.1.178
Patch178: vim-7.1.179
Patch179: vim-7.1.180
Patch180: vim-7.1.181
Patch181: vim-7.1.182
Patch182: vim-7.1.183
Patch183: vim-7.1.184
Patch184: vim-7.1.185
Patch185: vim-7.1.186
Patch186: vim-7.1.187
Patch187: vim-7.1.188
Patch188: vim-7.1.189
Patch189: vim-7.1.190
Patch190: vim-7.1.191
Patch191: vim-7.1.192
Patch192: vim-7.1.193
Patch193: vim-7.1.194
Patch194: vim-7.1.195
Patch195: vim-7.1.196
Patch196: vim-7.1.197
Patch197: vim-7.1.198
Patch198: vim-7.1.199
Patch199: vim-7.1.200
Patch200: vim-7.1.201
Patch201: vim-7.1.202
Patch202: vim-7.1.203
Patch203: vim-7.1.204
Patch204: vim-7.1.205
Patch205: vim-7.1.206
Patch206: vim-7.1.207
Patch207: vim-7.1.208
Patch208: vim-7.1.209
Patch209: vim-7.1.210
Patch210: vim-7.1.211
Patch211: vim-7.1.212
Patch212: vim-7.1.213
Patch213: vim-7.1.214
Patch214: vim-7.1.215
Patch215: vim-7.1.216
Patch216: vim-7.1.217
Patch217: vim-7.1.218
Patch218: vim-7.1.219
Patch219: vim-7.1.220
Patch220: vim-7.1.221
Patch221: vim-7.1.222
Patch222: vim-7.1.223
Patch223: vim-7.1.224
Patch224: vim-7.1.225
Patch225: vim-7.1.226
Patch226: vim-7.1.227
Patch227: vim-7.1.228
Patch228: vim-7.1.229
Patch229: vim-7.1.230
Patch230: vim-7.1.231
Patch231: vim-7.1.232
Patch232: vim-7.1.233
Patch233: vim-7.1.234
Patch234: vim-7.1.235
Patch235: vim-7.1.236
Patch236: vim-7.1.237
Patch237: vim-7.1.238
Patch238: vim-7.1.239
Patch239: vim-7.1.240
Patch240: vim-7.1.241
Patch241: vim-7.1.242
Patch242: vim-7.1.243
Patch243: vim-7.1.244
Patch244: vim-7.1.245
Patch245: vim-7.1.246
Patch246: vim-7.1.247
Patch247: vim-7.1.248
Patch248: vim-7.1.249
Patch249: vim-7.1.250
Patch250: vim-7.1.251
Patch251: vim-7.1.252
Patch252: vim-7.1.253
Patch253: vim-7.1.254
Patch254: vim-7.1.255
Patch255: vim-7.1.256
Patch256: vim-7.1.257
Patch257: vim-7.1.258
Patch258: vim-7.1.259
Patch259: vim-7.1.260
Patch260: vim-7.1.261
Patch261: vim-7.1.262
Patch262: vim-7.1.263
Patch263: vim-7.1.264
Patch264: vim-7.1.265
Patch265: vim-7.1.266
Patch266: vim-7.1.267
Patch267: vim-7.1.268
Patch268: vim-7.1.269
Patch269: vim-7.1.270
Patch270: vim-7.1.271
Patch271: vim-7.1.272
Patch272: vim-7.1.273
Patch273: vim-7.1.274
Patch274: vim-7.1.275
Patch275: vim-7.1.276
Patch276: vim-7.1.277
Patch277: vim-7.1.278
Patch278: vim-7.1.279
Patch279: vim-7.1.280
Patch280: vim-7.1.281
Patch281: vim-7.1.282
Patch282: vim-7.1.283
Patch283: vim-7.1.284
Patch284: vim-7.1.285
Patch285: vim-7.1.286
Patch286: vim-7.1.287
Patch287: vim-7.1.288
Patch288: vim-7.1.289
Patch289: vim-7.1.290
Patch290: vim-7.1.291
Patch291: vim-7.1.292
Patch292: vim-7.1.293
Patch293: vim-7.1.294
Patch294: vim-7.1.295
Patch295: vim-7.1.296
Patch296: vim-7.1.297
Patch297: vim-7.1.298
Patch298: vim-7.1.299
Patch299: vim-7.1.300
Patch300: vim-7.1.301
Patch301: vim-7.1.302
Patch302: vim-7.1.303
Patch303: vim-7.1.304
Patch304: vim-7.1.305
Patch305: vim-7.1.306
Patch306: vim-7.1.307
Patch307: vim-7.1.308
Patch308: vim-7.1.309
Patch309: vim-7.1.310
Patch310: vim-7.1.311
Patch311: vim-7.1.312
Patch312: vim-7.1.313
Patch313: vim-7.1.314
Buildroot: %{_tmppath}/%{name}-buildroot
BuildRequires: coreutils, grep, sed, make, gcc, gettext, gtk2
BuildRequires: perl, python, ruby, ncurses, libattr, libacl
BuildRequires: libX11, libSM, libICE, libXt
Requires: %{name}-common = %{version}-%{release}
Obsoletes: vim-minimal, vim-enhanced

%description
VIM (VIsual editor iMproved) is an updated and improved version of the
vi editor.  Vi was the first real screen-based editor for UNIX, and is
still very popular.  VIM improves on vi by adding new features:
multiple windows, multi-level undo, block highlighting and more.


%package common
Summary: The common files needed by any version of the VIM editor.
Group: Applications/Editors

%description common
VIM (VIsual editor iMproved) is an updated and improved version of the
vi editor.  Vi was the first real screen-based editor for UNIX, and is
still very popular.  VIM improves on vi by adding new features:
multiple windows, multi-level undo, block highlighting and more.  The
vim-common package contains files which every VIM binary will need in
order to run.
If you are installing vim-enhanced or vim-X11, you'll also need
to install the vim-common package.


%package X11
Summary: The VIM version of the vi editor for the X Window System.
Group: Applications/Editors
Requires: vim-common = %{version}-%{release}

%description X11
VIM (VIsual editor iMproved) is an updated and improved version of the
vi editor.  Vi was the first real screen-based editor for UNIX, and is
still very popular.  VIM improves on vi by adding new features:
multiple windows, multi-level undo, block highlighting and
more. VIM-X11 is a version of the VIM editor which will run within the
X Window System.  If you install this package, you can run VIM as an X
application with a full GUI interface and mouse support.

Install the vim-X11 package if you'd like to try out a version of vi
with graphics and mouse capabilities.  You'll also need to install the
vim-common package.



%prep
%setup -q -c -a1
pushd vim??
%patch0 -p0
%patch1 -p0
%patch3 -p0
%patch4 -p0
%patch5 -p0
%patch7 -p0
%patch8 -p0
%patch9 -p0
%patch10 -p0
%patch11 -p0
%patch12 -p0
%patch13 -p0
%patch14 -p0
%patch15 -p0
%patch16 -p0
%patch17 -p0
%patch18 -p0
%patch19 -p0
%patch20 -p0
%patch21 -p0
%patch22 -p0
%patch23 -p0
%patch24 -p0
%patch25 -p0
%patch26 -p0
%patch27 -p0
%patch28 -p0
%patch29 -p0
%patch30 -p0
%patch31 -p0
%patch32 -p0
%patch33 -p0
%patch34 -p0
%patch35 -p0
%patch36 -p0
%patch37 -p0
%patch38 -p0
%patch39 -p0
%patch41 -p0
%patch42 -p0
%patch43 -p0
%patch44 -p0
%patch45 -p0
%patch46 -p0
%patch47 -p0
%patch48 -p0
%patch49 -p0
%patch50 -p0
%patch51 -p0
%patch52 -p0
%patch53 -p0
%patch54 -p0
%patch55 -p0
%patch56 -p0
%patch57 -p0
%patch58 -p0
%patch59 -p0
%patch60 -p0
%patch61 -p0
%patch62 -p0
%patch63 -p0
%patch65 -p0
%patch66 -p0
%patch67 -p0
%patch68 -p0
%patch70 -p0
%patch72 -p0
%patch73 -p0
%patch74 -p0
%patch75 -p0
%patch76 -p0
%patch77 -p0
%patch78 -p0
%patch80 -p0
%patch81 -p0
%patch82 -p0
%patch83 -p0
%patch84 -p0
%patch85 -p0
%patch86 -p0
%patch88 -p0
%patch89 -p0
%patch92 -p0
%patch93 -p0
%patch94 -p0
%patch95 -p0
%patch96 -p0
%patch97 -p0
%patch98 -p0
%patch99 -p0
%patch100 -p0
%patch101 -p0
%patch102 -p0
%patch103 -p0
%patch104 -p0
%patch105 -p0
%patch106 -p0
%patch107 -p0
%patch108 -p0
%patch109 -p0
%patch110 -p0
%patch111 -p0
%patch112 -p0
%patch113 -p0
%patch114 -p0
%patch115 -p0
%patch116 -p0
%patch117 -p0
%patch118 -p0
%patch119 -p0
%patch120 -p0
%patch121 -p0
%patch122 -p0
%patch124 -p0
%patch129 -p0
%patch130 -p0
%patch131 -p0
%patch132 -p0
%patch134 -p0
%patch135 -p0
%patch136 -p0
%patch137 -p0
%patch138 -p0
%patch139 -p0
%patch140 -p0
%patch141 -p0
%patch142 -p0
%patch143 -p0
%patch144 -p0
%patch147 -p0
%patch148 -p0
%patch149 -p0
%patch150 -p0
%patch151 -p0
%patch152 -p0
%patch153 -p0
%patch154 -p0
%patch155 -p0
%patch156 -p0
%patch158 -p0
%patch159 -p0
%patch160 -p0
%patch161 -p0
%patch162 -p0
%patch163 -p0
%patch164 -p0
%patch165 -p0
%patch166 -p0
%patch168 -p0
%patch169 -p0
%patch170 -p0
%patch171 -p0
%patch172 -p0
%patch173 -p0
%patch174 -p0
%patch175 -p0
%patch176 -p0
%patch177 -p0
%patch178 -p0
%patch179 -p0
%patch180 -p0
%patch181 -p0
%patch182 -p0
%patch183 -p0
%patch184 -p0
%patch186 -p0
%patch187 -p0
%patch188 -p0
%patch189 -p0
%patch190 -p0
%patch191 -p0
%patch192 -p0
%patch193 -p0
%patch194 -p0
%patch196 -p0
%patch197 -p0
%patch198 -p0
%patch199 -p0
%patch200 -p0
%patch201 -p0
%patch202 -p0
%patch204 -p0
%patch205 -p0
%patch206 -p0
%patch207 -p0
%patch208 -p0
%patch209 -p0
%patch210 -p0
%patch211 -p0
%patch212 -p0
%patch213 -p0
%patch214 -p0
%patch215 -p0
%patch216 -p0
%patch217 -p0
%patch218 -p0
%patch219 -p0
%patch220 -p0
%patch221 -p0
%patch222 -p0
%patch223 -p0
%patch224 -p0
%patch225 -p0
%patch226 -p0
%patch227 -p0
%patch228 -p0
%patch229 -p0
%patch230 -p0
%patch231 -p0
%patch232 -p0
%patch233 -p0
%patch234 -p0
%patch235 -p0
%patch236 -p0
%patch237 -p0
%patch238 -p0
%patch239 -p0
%patch240 -p0
%patch241 -p0
%patch242 -p0
%patch243 -p0
%patch244 -p0
%patch245 -p0
%patch246 -p0
%patch247 -p0
%patch248 -p0
%patch249 -p0
%patch250 -p0
%patch251 -p0
%patch252 -p0
%patch253 -p0
%patch254 -p0
%patch255 -p0
%patch256 -p0
%patch257 -p0
%patch258 -p0
%patch259 -p0
%patch260 -p0
%patch261 -p0
%patch262 -p0
%patch263 -p0
%patch264 -p0
%patch265 -p0
%patch266 -p0
%patch267 -p0
%patch268 -p0
%patch269 -p0
%patch270 -p0
%patch271 -p0
%patch272 -p0
%patch273 -p0
%patch275 -p0
%patch276 -p0
%patch278 -p0
%patch280 -p0
%patch283 -p0
%patch285 -p0
%patch286 -p0
%patch287 -p0
%patch288 -p0
%patch289 -p0
%patch290 -p0
%patch291 -p0
%patch292 -p0
%patch293 -p0
%patch294 -p0
%patch295 -p0
%patch296 -p0
%patch297 -p0
%patch298 -p0
%patch299 -p0
%patch300 -p0
%patch301 -p0
%patch302 -p0
%patch303 -p0
%patch304 -p0
%patch305 -p0
%patch306 -p0
%patch307 -p0
%patch308 -p0
%patch309 -p0
%patch310 -p0
%patch311 -p0
%patch312 -p0
%patch313 -p0
popd


%define vimdir vim%(echo %{version} | %{__sed} 's,\\.,,')
%build
pushd '%{vimdir}'

# First build the X-enabled version, and save it
%configure \
	--with-features=huge \
	--with-x \
	--enable-xim \
	--enable-multibyte \
	--enable-gtk2-check \
	--enable-gui=gtk2 \
	--with-compiledby='<bugzilla@veith-m.de>' \
	--enable-rubyinterp \
	--enable-perlinterp \
	--enable-pythoninterp \
	--disable-tclinterp
%{__make} %{?_smp_mflags}
cd src && %{__mv} -v vim gvim && cd ..

# Clean up for the next build
%{__make} clean

# This is vim-enhanced, but without X
%configure \
	--with-features=huge \
	--without-x \
	--disable-gui \
	--disable-xim \
	--enable-multibyte \
	--with-compiledby='<bugzilla@veith-m.de>' \
	--enable-rubyinterp \
	--enable-perlinterp \
	--enable-pythoninterp \
	--disable-tclinterp
%{__make} %{?_smp_mflags}

popd


%install
[[ '%{buildroot}' != '/' ]] && %{__rm} -rf '%{buildroot}'

pushd "%{vimdir}"

%{__make_install} -C src DESTDIR='%{buildroot}'

# Install previously created X11-enabled vim binary
%{__install} -m 0755 src/gvim '%{buildroot}/%{_bindir}/gvim'

# Create links for X11-enabled vim
pushd '%{buildroot}/%{_bindir}'
for link in evim gex gview gvimdiff vimx
do
	%{__ln_s} gvim "${link}"
done
popd

# Icons for gvim
%{__mkdir_p} '%{buildroot}/%{_datadir}/icons/hicolor'/{16x16,32x32,48x48}/apps
for size in 16x16 32x32 48x48
do
	%{__install} -m 0644 "runtime/vim${size}.png" \
	"%{buildroot}/%{_datadir}/icons/hicolor/${size}/apps/vim.png"
done

# Make sure the manpages are set up correctly
pushd '%{buildroot}/%{_mandir}'
for path in $(find . -name vim.1\* -or -name vimdiff.1\*)
do
	basename="${path##*/}"
	dir="${path%/*}"
	pushd "${dir}"
	%{__ln_s} "${basename}" "g${basename}"
	popd
done
popd

[[ -e '%{buildroot}/%{_infodir}/dir' ]] \
    && %{__rm} -f '%{buildroot}/%{_infodir}/dir'

popd


%post

%postun


%clean
[[ '%{buildroot}' != '/' ]] && %{__rm} -rf '%{buildroot}'


%files
%defattr(-, root, root)
%doc vim??/README*
%{_bindir}/ex
%{_bindir}/rview
%{_bindir}/rvim
%{_bindir}/view
%{_bindir}/vim
%{_bindir}/vimdiff
%{_bindir}/vimtutor
%{_bindir}/xxd
%doc %{_mandir}/man1/ex.1*
%doc %{_mandir}/man1/gvim.1*
%doc %{_mandir}/man1/gvimdiff.1*
%doc %{_mandir}/man1/rview.1*
%doc %{_mandir}/man1/rvim.1*
%doc %{_mandir}/man1/view.1*
%doc %{_mandir}/man1/vim.1*
%doc %{_mandir}/man1/vimdiff.1*
%doc %{_mandir}/man1/vimtutor.1*
%doc %{_mandir}/man1/xxd.1*
%doc %{_mandir}/*/man1/ex.1*
%doc %{_mandir}/*/man1/gvim.1*
%doc %{_mandir}/*/man1/gvimdiff.1*
%doc %{_mandir}/*/man1/rview.1*
%doc %{_mandir}/*/man1/rvim.1*
%doc %{_mandir}/*/man1/view.1*
%doc %{_mandir}/*/man1/vim.1*
%doc %{_mandir}/*/man1/vimdiff.1*
%doc %{_mandir}/*/man1/vimtutor.1*
%doc %{_mandir}/*/man1/xxd.1*

%files X11
%defattr(-, root, root)
%doc vim??/README*
%{_bindir}/evim
%{_bindir}/gex
%{_bindir}/gview
%{_bindir}/gvim
%{_bindir}/gvimdiff
%{_bindir}/gvimtutor
%{_bindir}/vimx
%{_datadir}/icons/hicolor/*/apps/vim.png
%doc %{_mandir}/man1/evim.1*
%doc %{_mandir}/man1/gvim.1*
%doc %{_mandir}/man1/gvimdiff.1*
%doc %{_mandir}/*/man1/evim.1*
%doc %{_mandir}/*/man1/gvim.1*
%doc %{_mandir}/*/man1/gvimdiff.1*

%files common
%defattr(-, root, root)
%{_datadir}/vim/
